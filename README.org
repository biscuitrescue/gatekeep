#+TITLE: Gatekeep ğŸ›¡ï¸
#+AUTHOR: Your Name
#+DATE: 2025
#+OPTIONS: toc:nil

Gatekeep is a *Git-native, policy-as-code platform* for managing SSH access across Linux and BSD servers â€” using declarative YAML files, version control, and lightweight agents.


It replaces fragile scripts and manual key syncing with a secure, auditable, and developer-first approach to server access.

---

* âœ¨ Features
- ğŸ” *Policy-as-Code*: Define SSH access in simple, structured YAML.
- ğŸ§  *Smart Agents*: Each server runs a lightweight daemon to pull and apply access policy.
- ğŸ§¾ *Audit-Ready*: Git history = full changelog of who had access and when.
- ğŸ” *Key Rotation*: Keys can have expiry metadata and auto-rotation plans.
- ğŸ’» *CLI Tool*: Query access, test policies, and generate ~authorized_keys~ files locally.
- ğŸ”’ *Secure Sync* (planned): Signed policies and cryptographic validation.
- ğŸ’¡ *Self-Hosted or SaaS* (planned): Bring your own Git or use Gatekeep Cloud.

---

* ğŸ“ Project Structure
#+begin_src bash
gatekeep/
â”œâ”€â”€ agent/       # C++ agent daemon
â”œâ”€â”€ backend/     # (Planned) Audit, auth, key signing server
â”œâ”€â”€ cli/         # Rust CLI tool (gatekeep)
â”œâ”€â”€ core/        # Shared logic: YAML parsing, policy evaluation
â”œâ”€â”€ docs/        # Architecture, design, schema
â”œâ”€â”€ policies/    # Sample YAML policies for dev/demo
â”œâ”€â”€ README.md
#+end_src

---

* ğŸ“ Example Policy
#+begin_src yaml
users:
    alice:
        key: ssh-ed25519 AAAAC3Nza... alice@laptop
        groups: [devs]

    bob:
        key: ssh-rsa AAAAB3... bob@home
        groups: [ops]

servers:
    web-1:
        allow: [devs]

    db-1:
        allow: [ops]
#+end_src

---

* ğŸš€ Getting Started

**CLI**
#+begin_src bash
# Clone the repo
git clone https://github.com/your-org/gatekeep
cd gatekeep

# Build the CLI
cd cli
cargo build --release

# Generate authorized_keys for a server
../target/release/gatekeep generate --server web-1 --policy ../policies/access.yaml
#+end_src

**CLI Usage**
#+begin_src bash
gk generate --server <hostname> --policy access.yaml
gk check-access alice web-1
gk validate access.yaml
#+end_src

---

* âš™ï¸ Agent

A minimal daemon installed on every server:

- Pulls latest policy (from Git or API)
- Generates keys using the CLI
- Writes them to ~/etc/ssh/authorized_keys.d/~
- Optionally verifies signatures
- Runs as a systemd service or cronjob

Setup docs: =docs/agent_install.md= (coming soon)

---

* ğŸ—º Roadmap
- [ ] Agent policy signature verification
- [ ] FIDO2/WebAuthn support for agents
- [ ] Gatekeep Web UI (read-only dashboard)
- [ ] GitHub/GitLab integration
- [ ] Audit log backend API
- [ ] SaaS + On-prem deployment support

---

* ğŸ“œ License
BSDv3 License Â© 2025

---
